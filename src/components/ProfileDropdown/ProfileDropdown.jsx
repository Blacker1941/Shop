import React, { useEffect, useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { FaEdit, FaSignOutAlt, FaTrash ,FaSave} from "react-icons/fa";
import { MdOutlineCancel } from "react-icons/md";
import { TiTickOutline } from "react-icons/ti";
import { useTranslation } from 'react-i18next';
import "../../css/components/profileDropdown.css";
import { useNavigate } from "react-router-dom";

export default function ProfileModal({ onClose }) {
  const { t, i18n } = useTranslation(); 
  const [user, setUser] = useState(null);
  const [mode, setMode] = useState("view"); 
  const [preview, setPreview] = useState(null);
  const navigate = useNavigate();

  useEffect(() => {
    const loggedUser = JSON.parse(localStorage.getItem("loggedUser"));
    if (loggedUser) setUser(loggedUser);
  }, []);

  const handleLogout = () => {
    localStorage.removeItem("loggedUser");
    localStorage.removeItem("isLoggedIn");
    setUser(null);
    setMode("view");
    onClose();
  };

  const handleDelete = () => {
    localStorage.removeItem("loggedUser");
    localStorage.removeItem("isLoggedIn");
    setUser(null);
    setMode("view");
    onClose();
  };

  const handleAvatarChange = (e) => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onloadend = () => {
      setPreview(reader.result); 
    };
    reader.readAsDataURL(file);
  };

  const handleSave = () => {
    const updatedUser = {
      ...user,
      name: document.getElementById("editName").value,
      email: document.getElementById("editEmail").value,
      avatar: preview || user.avatar,
    };
    localStorage.setItem("loggedUser", JSON.stringify(updatedUser));
    setUser(updatedUser);
    setMode("view");
  };

  return (
    <AnimatePresence>
      <motion.div
        className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        exit={{ opacity: 0 }}
        onClick={onClose}
      >
        <motion.div
          className="profile-dropdown relative"
          initial={{ scale: 0.9, y: -30, opacity: 0 }}
          animate={{ scale: 1, y: 0, opacity: 1 }}
          exit={{ scale: 0.9, y: -30, opacity: 0 }}
          transition={{ duration: 0.3 }}
          onClick={(e) => e.stopPropagation()}
        >
          {!user ? (
            <div className="text-center">
              <p className="text-lg mb-4"> {t('profileModal.notLoggedIn')}</p>
              <button  onClick={() => navigate("/login")} className="btn-primary"> 
                {t('profileModal.loginButton')}
              </button>
            </div>
          ) : (
            <>
              {mode === "view" && (
                <>
                  <div className="profile-header">
                    <img
                      src={
                        user.avatar ||
                        "data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20980%20980%22%20fill%3D%22none%22%20shape-rendering%3D%22auto%22%20width%3D%22512%22%20height%3D%22512%22%3E%3Cmetadata%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Adcterms%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fterms%2F%22%3E%3Crdf%3ARDF%3E%3Crdf%3ADescription%3E%3Cdc%3Atitle%3ELorelei%3C%2Fdc%3Atitle%3E%3Cdc%3Acreator%3ELisa%20Wischofsky%3C%2Fdc%3Acreator%3E%3Cdc%3Asource%20xsi%3Atype%3D%22dcterms%3AURI%22%3Ehttps%3A%2F%2Fwww.figma.com%2Fcommunity%2Ffile%2F1198749693280469639%3C%2Fdc%3Asource%3E%3Cdcterms%3Alicense%20xsi%3Atype%3D%22dcterms%3AURI%22%3Ehttps%3A%2F%2Fcreativecommons.org%2Fpublicdomain%2Fzero%2F1.0%2F%3C%2Fdcterms%3Alicense%3E%3Cdc%3Arights%3ERemix%20of%20%E2%80%9ELorelei%E2%80%9D%20(https%3A%2F%2Fwww.figma.com%2Fcommunity%2Ffile%2F1198749693280469639)%20by%20%E2%80%9ELisa%20Wischofsky%E2%80%9D%2C%20licensed%20under%20%E2%80%9ECC0%201.0%E2%80%9D%20(https%3A%2F%2Fcreativecommons.org%2Fpublicdomain%2Fzero%2F1.0%2F)%3C%2Fdc%3Arights%3E%3C%2Frdf%3ADescription%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cmask%20id%3D%22viewboxMask%22%3E%3Crect%20width%3D%22980%22%20height%3D%22980%22%20rx%3D%220%22%20ry%3D%220%22%20x%3D%220%22%20y%3D%220%22%20fill%3D%22%23fff%22%20%2F%3E%3C%2Fmask%3E%3Cg%20mask%3D%22url(%23viewboxMask)%22%3E%3Cg%20transform%3D%22translate(10%20-60)%22%3E%3Cpath%20d%3D%22M269%20153c13-1%2027%201%2040%204%2017%205%2034%2011%2050%2020a91%2091%200%200%201%2044%2043h41l47-1a284%20284%200%200%201%20150%2043l22%2016%2022%2024a58%2058%200%200%201%208%2067c-2%204-7%206-11%203s-6-8-9-13l-16-26-10-23-35-1c-4%200-8-1-11-4l-14-10c-1%204-3%209-6%2012-3%204-9%200-13-1-22-4-44-6-67-6-24%200-47%203-71%206l-23%204-8-2-18-5%203%2017-1%2014c0%204-3%208-5%2012l-19%2037c-6%2017-12%2034-16%2052%200%202-1%204-3%205l-12%202c5%209%206%2020%205%2030-1%2012-3%2025-9%2036%207%209%209%2020%2010%2032%202%2019%200%2038-7%2055-2%205-5%2010-10%2012-1%201-4%201-4-1-2-3-2-7-2-11l-3-13-18-1c-8-2-16-7-21-14l-9-10a233%20233%200%200%201-28-159c6-39%2021-76%2044-107a330%20330%200%200%200-87%2053c-6-6-8-14-8-22%201-19%209-36%2021-51-19%2010-35%2022-51%2035-3%202-5%205-9%205l-7-10c-3-11%201-24%207-33%209-16%2025-29%2039-40%204-4%2010-8%2013-13%201-2%200-6-2-7l-9-3c-2-1-2-3%200-5%2012-13%2029-17%2045-22%2030-7%2061-9%2091-3-17-7-34-13-52-16h-11l1-2c3-3%208-4%2012-4Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M495%20234c28%201%2056%206%2084%2015a201%20201%200%200%201%20100%2065c19%2025%2031%2055%2035%2086a361%20361%200%200%201%202%20101l-5%2034-4%2020c-1%202-1%202-3%202-2-4-2-8-2-12-1-15%201-29%202-44%201-24%203-48%201-72l-6-45c-7-28-20-54-40-75-18-18-40-33-63-43-22-9-44-15-67-19-18-3-36-4-54-4a277%20277%200%200%200-128%2029c-13%209-25%2020-35%2032a276%20276%200%200%200-55%20139c-1%2024%200%2047%208%2070l7%2015%2012%201%201%203c-3%202-7%202-11%203-10%202-20%206-29%2012-7%205-14%2011-18%2019-5%2010-3%2022-1%2033%205%2019%2017%2037%2033%2049%2011%209%2025%2014%2039%2016%2010%202%2020%200%2030-1%205%204%208%2012%2011%2017l18%2027a136%20136%200%200%200%2066%2050c22%209%2045%2014%2068%2019l41%208%2017%205v4h-12a535%20535%200%200%201-67-8%20255%20255%200%200%201-84-33c-11-7-21-16-29-27a214%20214%200%200%201-16%20123c-15%2027-40%2048-70%2057-3%201-7%202-10%201-2%200-2-1-2-3%201-3%204-5%206-6%2012-8%2026-14%2038-23%2013-11%2024-23%2031-38%206-15%2010-32%2012-49%202-13%203-26%202-40l-4-38-18-36-19%204a88%2088%200%200%201-75-38%2093%2093%200%200%201-20-58c0-9%203-18%208-25s12-13%2019-17c5-4%2012-6%2018-8l-9-24c-5-22-5-45-2-67a292%20292%200%200%201%2063-149c9-10%2018-19%2029-26%207-4%2014-5%2020-9%2043-19%2090-25%20137-22Z%22%20fill%3D%22%23000%22%2F%3E%3Cpath%20d%3D%22M475%20243a276%20276%200%200%201%20121%2023c23%2010%2045%2025%2063%2043%2020%2021%2033%2047%2040%2075l6%2045c2%2024%200%2048-1%2072-1%2015-3%2029-2%2044%200%204%200%208%202%2012l-1%2020c-2%205-2%2010-2%2016-2%2024-2%2049-6%2074-1%2012-3%2025-8%2036-3%209-8%2017-15%2024-12%2013-27%2024-43%2033-19%2011-39%2016-58%2024-5%202-10%204-13%208%208%201%2015%200%2023-2-5%2012-6%2024-6%2036%200%205-1%2011%201%2016%203%205%208%209%2013%2012l35%2013c22%208%2043%2018%2065%2027%202%204%205%207%206%2012%206%2011%207%2023%203%2035-5%2013-15%2024-27%2031-16%2011-36%2019-55%2024a494%20494%200%200%201-235-7c-20-7-40-14-58-24-14-8-29-18-40-31-6-8-11-19-12-29a122%20122%200%200%200%2086-107c4-24%204-49%200-73%208%2011%2018%2020%2029%2027l27%2014a331%20331%200%200%200%20124%2027h12v-4l-17-5-41-8c-23-5-46-10-68-19-13-6-27-13-39-21-10-9-19-18-27-29l-18-27c-3-5-6-13-11-17-10%201-20%203-30%201-14-2-28-7-39-16a94%2094%200%200%201-33-49c-2-11-4-23%201-33%204-8%2011-14%2018-19%209-6%2019-10%2029-12%204-1%208-1%2011-3l-1-3-12-1-7-15c-8-23-9-46-7-70a276%20276%200%200%201%2054-139c10-12%2022-23%2035-32a277%20277%200%200%201%20128-30Z%22%20fill%3D%22%23ffffff%22%2F%3E%3Cpath%20d%3D%22M260%20571c4%200%207%200%2011%202%205%201%2011%204%2014%208%202%203%202%207%200%2010-5%206-12%2010-16%2016%206%204%2014%206%2021%209%204%201%208%203%2011%206l1%203-8-2-24-7c-4-1-8-3-9-7-1-3%201-7%203-10l15-13c-4-7-15-8-19-15ZM703%20577l2%203%202%2016a483%20483%200%200%201-2%2089c-2%2011-5%2023-10%2033a198%20198%200%200%201-106%2071c-1%2014-3%2031-2%2047l5%205c8%206%2018%209%2027%2012a451%20451%200%200%201%2068%2028c7%204%2013%209%2018%2015-5%201-10-1-16-2-22-9-43-19-65-27l-35-13c-5-3-10-7-13-12-2-5-1-11-1-16%200-12%201-24%206-36-8%202-15%203-23%202%203-4%208-6%2013-8%2019-8%2039-13%2058-24%2016-9%2031-20%2043-33%207-7%2012-15%2015-24%205-11%207-24%208-36%204-25%204-50%206-74%200-6%200-11%202-16Z%22%20fill%3D%22%23000%22%2F%3E%3Cpath%20d%3D%22M681%20473c6%202%2012%207%2015%2013%202%203%202%206%200%209-2%204-8%206-12%203-4-2-6-6-9-9-7-3-13-2-19%200%203%203%206%206%207%2010%204%2012%203%2025-2%2036l10-5c0%204%200%207-2%2011-5%206-13%2010-20%2011-9%201-17%202-25-2-4-3-5-7-5-11l-2-10c0-7%203-13%206-19%207-14%2018-26%2031-33%208-4%2018-6%2027-4ZM456%20484c27%201%2053%2017%2065%2041%202%203%203%206%201%2010-3-1-4-3-6-6-6-9-13-17-22-23-10-6-22-9-34-9%206%2010%209%2021%208%2032-1%209-4%2019-12%2026%204%201%207%202%209%204-6%203-13%203-20%201-9-2-17-6-25-11-8-6-16-13-20-23l-4-8c-2-4-1-8%202-11l10-9c14-10%2031-15%2048-14Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M480%20404c10%201%2019%200%2029%203%209%203%2018%2010%2022%2019%204%206%202%2016-6%2019-6%204-15%203-23%202-20-3-40-9-60-14l-20-4-10-2-4-4c2-4%206-6%2010-7l20-7%2018-3%2024-2ZM656%20410c8%201%2015%204%2022%207l9%204c2%202%203%206%201%208l-10%204c-17%204-33%2011-51%2012l-9%201c-3%200-6-2-8-4-3-2-4-5-4-9%200-7%202-15%208-20%204-3%2011-4%2016-5%208%200%2017%200%2026%202Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M609%20602c1%209-4%2016-9%2023-4%203-9%206-15%206s-13-3-19-5c-4-2-8-3-11-6l5-4c9-1%2017%203%2025%204%204%200%207-3%209-6%205-5%209-10%2015-12Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M667%20657c2%200%204%200%205%202%202%202%201%205-1%206l-16%204c-21%203-42%207-64%209-6%200-12%202-17%200l15-5%2062-13%2016-3Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M508%20220a271%20271%200%200%201%2097%2024c14%207%2029%2014%2042%2023%208%205%2016%2011%2022%2018l22%2025c-9%204-18%203-27%202-17-2-34-4-51-3l-8-1-7-5-12-8c0%204-1%207-3%2011-2%202-4%203-7%203-4-1-7-3-11-3a470%20470%200%200%200-155%203h-11l-18-6c1%209%204%2018%203%2026-1%204-1%208-3%2011-7%2014-15%2027-21%2042-7%2017-13%2035-17%2053%200%202-1%204-3%205l-12%202c5%209%206%2020%205%2030-1%2012-3%2026-9%2036%207%209%2010%2021%2010%2033%201%2019%200%2037-7%2055-2%204-5%209-10%2011-1%201-4%201-4-1-2-4-2-9-3-13-2-15-9-29-20-40-8-7-17-14-26-19-6-2-11-4-16-8l-6-8c-12-32-16-67-12-101a285%20285%200%200%201%2037-113c10-16%2022-30%2035-43%2010-9%2020-17%2031-23l14-5%2032-11%2019-2h43c23%200%2044-2%2067%200Z%22%20fill%3D%22%23000000%22%2F%3E%3C%2Fg%3E%3Cg%20transform%3D%22translate(10%20-60)%22%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E"
                      }
                      alt="avatar"
                      className="avatar"
                    />
                    
                  </div>
                  <div className="name">
                      <p className="font-bold">{user.name} </p>
                      <p className="email">{user.email}</p>
                      {user.role && (
                        <p className="text-xs text-yellow-500">
                          {t('profileModal.role')} {user.role}
                        </p>
                      )}
                    </div>
                    
                  <div className="mb-4">
                    <div className="w-full bg-gray-200 rounded-full h-2 mt-1">
                      <div
                        className="bg-blue-500 h-2 rounded-full"
                        style={{ width: `${user.progress || 40}%` }}
                      ></div>
                    </div>
                  </div>

                  {user.joinDate && (
                    <p className="text-sm mb-1">
                      {t('profileModal.joinDate')}{' '}
                      {new Date(user.joinDate).toLocaleDateString(i18n.language === 'fa' ? 'fa-IR' : 'en-US')}
                    </p>
                  )}
                  {user.lastLogin && (
                    <p className="last-login">
                      {t('profileModal.lastLogin')}{' '}{new Date(user.lastLogin).toLocaleString(  i18n.language === 'fa' ? 'fa-IR' : 'en-US')}
                    </p>
                  )}

                  <div className="profile-actions">
                    <button
                      onClick={() => setMode("edit")}
                      className="btn-primary"
                    >
                      <FaEdit /> {t('profileModal.editButton')}
                    </button>
                    <button
                      onClick={() => setMode("logout")}
                      className="btn-secondary"
                    >
                      <FaSignOutAlt /> {t('profileModal.logoutButton')}
                    </button>
                    <button
                      onClick={() => setMode("delete")}
                      className="btn-danger"
                    >
                      <FaTrash /> {t("profileModal.deleteButton")}
                    </button>
                  </div>
                </>
              )}

              {mode === "edit" && (
                <div className="text-center">
                  <p className="mb-3">{t("profileModal.editButton")}</p>

                  <div className="mb-3">
                    <img
                      src={
                        preview ||
                        user.avatar ||
                        "data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20980%20980%22%20fill%3D%22none%22%20shape-rendering%3D%22auto%22%20width%3D%22512%22%20height%3D%22512%22%3E%3Cmetadata%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Adcterms%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fterms%2F%22%3E%3Crdf%3ARDF%3E%3Crdf%3ADescription%3E%3Cdc%3Atitle%3ELorelei%3C%2Fdc%3Atitle%3E%3Cdc%3Acreator%3ELisa%20Wischofsky%3C%2Fdc%3Acreator%3E%3Cdc%3Asource%20xsi%3Atype%3D%22dcterms%3AURI%22%3Ehttps%3A%2F%2Fwww.figma.com%2Fcommunity%2Ffile%2F1198749693280469639%3C%2Fdc%3Asource%3E%3Cdcterms%3Alicense%20xsi%3Atype%3D%22dcterms%3AURI%22%3Ehttps%3A%2F%2Fcreativecommons.org%2Fpublicdomain%2Fzero%2F1.0%2F%3C%2Fdcterms%3Alicense%3E%3Cdc%3Arights%3ERemix%20of%20%E2%80%9ELorelei%E2%80%9D%20(https%3A%2F%2Fwww.figma.com%2Fcommunity%2Ffile%2F1198749693280469639)%20by%20%E2%80%9ELisa%20Wischofsky%E2%80%9D%2C%20licensed%20under%20%E2%80%9ECC0%201.0%E2%80%9D%20(https%3A%2F%2Fcreativecommons.org%2Fpublicdomain%2Fzero%2F1.0%2F)%3C%2Fdc%3Arights%3E%3C%2Frdf%3ADescription%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cmask%20id%3D%22viewboxMask%22%3E%3Crect%20width%3D%22980%22%20height%3D%22980%22%20rx%3D%220%22%20ry%3D%220%22%20x%3D%220%22%20y%3D%220%22%20fill%3D%22%23fff%22%20%2F%3E%3C%2Fmask%3E%3Cg%20mask%3D%22url(%23viewboxMask)%22%3E%3Cg%20transform%3D%22translate(10%20-60)%22%3E%3Cpath%20d%3D%22M269%20153c13-1%2027%201%2040%204%2017%205%2034%2011%2050%2020a91%2091%200%200%201%2044%2043h41l47-1a284%20284%200%200%201%20150%2043l22%2016%2022%2024a58%2058%200%200%201%208%2067c-2%204-7%206-11%203s-6-8-9-13l-16-26-10-23-35-1c-4%200-8-1-11-4l-14-10c-1%204-3%209-6%2012-3%204-9%200-13-1-22-4-44-6-67-6-24%200-47%203-71%206l-23%204-8-2-18-5%203%2017-1%2014c0%204-3%208-5%2012l-19%2037c-6%2017-12%2034-16%2052%200%202-1%204-3%205l-12%202c5%209%206%2020%205%2030-1%2012-3%2025-9%2036%207%209%209%2020%2010%2032%202%2019%200%2038-7%2055-2%205-5%2010-10%2012-1%201-4%201-4-1-2-3-2-7-2-11l-3-13-18-1c-8-2-16-7-21-14l-9-10a233%20233%200%200%201-28-159c6-39%2021-76%2044-107a330%20330%200%200%200-87%2053c-6-6-8-14-8-22%201-19%209-36%2021-51-19%2010-35%2022-51%2035-3%202-5%205-9%205l-7-10c-3-11%201-24%207-33%209-16%2025-29%2039-40%204-4%2010-8%2013-13%201-2%200-6-2-7l-9-3c-2-1-2-3%200-5%2012-13%2029-17%2045-22%2030-7%2061-9%2091-3-17-7-34-13-52-16h-11l1-2c3-3%208-4%2012-4Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M495%20234c28%201%2056%206%2084%2015a201%20201%200%200%201%20100%2065c19%2025%2031%2055%2035%2086a361%20361%200%200%201%202%20101l-5%2034-4%2020c-1%202-1%202-3%202-2-4-2-8-2-12-1-15%201-29%202-44%201-24%203-48%201-72l-6-45c-7-28-20-54-40-75-18-18-40-33-63-43-22-9-44-15-67-19-18-3-36-4-54-4a277%20277%200%200%200-128%2029c-13%209-25%2020-35%2032a276%20276%200%200%200-55%20139c-1%2024%200%2047%208%2070l7%2015%2012%201%201%203c-3%202-7%202-11%203-10%202-20%206-29%2012-7%205-14%2011-18%2019-5%2010-3%2022-1%2033%205%2019%2017%2037%2033%2049%2011%209%2025%2014%2039%2016%2010%202%2020%200%2030-1%205%204%208%2012%2011%2017l18%2027a136%20136%200%200%200%2066%2050c22%209%2045%2014%2068%2019l41%208%2017%205v4h-12a535%20535%200%200%201-67-8%20255%20255%200%200%201-84-33c-11-7-21-16-29-27a214%20214%200%200%201-16%20123c-15%2027-40%2048-70%2057-3%201-7%202-10%201-2%200-2-1-2-3%201-3%204-5%206-6%2012-8%2026-14%2038-23%2013-11%2024-23%2031-38%206-15%2010-32%2012-49%202-13%203-26%202-40l-4-38-18-36-19%204a88%2088%200%200%201-75-38%2093%2093%200%200%201-20-58c0-9%203-18%208-25s12-13%2019-17c5-4%2012-6%2018-8l-9-24c-5-22-5-45-2-67a292%20292%200%200%201%2063-149c9-10%2018-19%2029-26%207-4%2014-5%2020-9%2043-19%2090-25%20137-22Z%22%20fill%3D%22%23000%22%2F%3E%3Cpath%20d%3D%22M475%20243a276%20276%200%200%201%20121%2023c23%2010%2045%2025%2063%2043%2020%2021%2033%2047%2040%2075l6%2045c2%2024%200%2048-1%2072-1%2015-3%2029-2%2044%200%204%200%208%202%2012l-1%2020c-2%205-2%2010-2%2016-2%2024-2%2049-6%2074-1%2012-3%2025-8%2036-3%209-8%2017-15%2024-12%2013-27%2024-43%2033-19%2011-39%2016-58%2024-5%202-10%204-13%208%208%201%2015%200%2023-2-5%2012-6%2024-6%2036%200%205-1%2011%201%2016%203%205%208%209%2013%2012l35%2013c22%208%2043%2018%2065%2027%202%204%205%207%206%2012%206%2011%207%2023%203%2035-5%2013-15%2024-27%2031-16%2011-36%2019-55%2024a494%20494%200%200%201-235-7c-20-7-40-14-58-24-14-8-29-18-40-31-6-8-11-19-12-29a122%20122%200%200%200%2086-107c4-24%204-49%200-73%208%2011%2018%2020%2029%2027l27%2014a331%20331%200%200%200%20124%2027h12v-4l-17-5-41-8c-23-5-46-10-68-19-13-6-27-13-39-21-10-9-19-18-27-29l-18-27c-3-5-6-13-11-17-10%201-20%203-30%201-14-2-28-7-39-16a94%2094%200%200%201-33-49c-2-11-4-23%201-33%204-8%2011-14%2018-19%209-6%2019-10%2029-12%204-1%208-1%2011-3l-1-3-12-1-7-15c-8-23-9-46-7-70a276%20276%200%200%201%2054-139c10-12%2022-23%2035-32a277%20277%200%200%201%20128-30Z%22%20fill%3D%22%23ffffff%22%2F%3E%3Cpath%20d%3D%22M260%20571c4%200%207%200%2011%202%205%201%2011%204%2014%208%202%203%202%207%200%2010-5%206-12%2010-16%2016%206%204%2014%206%2021%209%204%201%208%203%2011%206l1%203-8-2-24-7c-4-1-8-3-9-7-1-3%201-7%203-10l15-13c-4-7-15-8-19-15ZM703%20577l2%203%202%2016a483%20483%200%200%201-2%2089c-2%2011-5%2023-10%2033a198%20198%200%200%201-106%2071c-1%2014-3%2031-2%2047l5%205c8%206%2018%209%2027%2012a451%20451%200%200%201%2068%2028c7%204%2013%209%2018%2015-5%201-10-1-16-2-22-9-43-19-65-27l-35-13c-5-3-10-7-13-12-2-5-1-11-1-16%200-12%201-24%206-36-8%202-15%203-23%202%203-4%208-6%2013-8%2019-8%2039-13%2058-24%2016-9%2031-20%2043-33%207-7%2012-15%2015-24%205-11%207-24%208-36%204-25%204-50%206-74%200-6%200-11%202-16Z%22%20fill%3D%22%23000%22%2F%3E%3Cpath%20d%3D%22M681%20473c6%202%2012%207%2015%2013%202%203%202%206%200%209-2%204-8%206-12%203-4-2-6-6-9-9-7-3-13-2-19%200%203%203%206%206%207%2010%204%2012%203%2025-2%2036l10-5c0%204%200%207-2%2011-5%206-13%2010-20%2011-9%201-17%202-25-2-4-3-5-7-5-11l-2-10c0-7%203-13%206-19%207-14%2018-26%2031-33%208-4%2018-6%2027-4ZM456%20484c27%201%2053%2017%2065%2041%202%203%203%206%201%2010-3-1-4-3-6-6-6-9-13-17-22-23-10-6-22-9-34-9%206%2010%209%2021%208%2032-1%209-4%2019-12%2026%204%201%207%202%209%204-6%203-13%203-20%201-9-2-17-6-25-11-8-6-16-13-20-23l-4-8c-2-4-1-8%202-11l10-9c14-10%2031-15%2048-14Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M480%20404c10%201%2019%200%2029%203%209%203%2018%2010%2022%2019%204%206%202%2016-6%2019-6%204-15%203-23%202-20-3-40-9-60-14l-20-4-10-2-4-4c2-4%206-6%2010-7l20-7%2018-3%2024-2ZM656%20410c8%201%2015%204%2022%207l9%204c2%202%203%206%201%208l-10%204c-17%204-33%2011-51%2012l-9%201c-3%200-6-2-8-4-3-2-4-5-4-9%200-7%202-15%208-20%204-3%2011-4%2016-5%208%200%2017%200%2026%202Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M609%20602c1%209-4%2016-9%2023-4%203-9%206-15%206s-13-3-19-5c-4-2-8-3-11-6l5-4c9-1%2017%203%2025%204%204%200%207-3%209-6%205-5%209-10%2015-12Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M667%20657c2%200%204%200%205%202%202%202%201%205-1%206l-16%204c-21%203-42%207-64%209-6%200-12%202-17%200l15-5%2062-13%2016-3Z%22%20fill%3D%22%23000000%22%2F%3E%3Cpath%20d%3D%22M508%20220a271%20271%200%200%201%2097%2024c14%207%2029%2014%2042%2023%208%205%2016%2011%2022%2018l22%2025c-9%204-18%203-27%202-17-2-34-4-51-3l-8-1-7-5-12-8c0%204-1%207-3%2011-2%202-4%203-7%203-4-1-7-3-11-3a470%20470%200%200%200-155%203h-11l-18-6c1%209%204%2018%203%2026-1%204-1%208-3%2011-7%2014-15%2027-21%2042-7%2017-13%2035-17%2053%200%202-1%204-3%205l-12%202c5%209%206%2020%205%2030-1%2012-3%2026-9%2036%207%209%2010%2021%2010%2033%201%2019%200%2037-7%2055-2%204-5%209-10%2011-1%201-4%201-4-1-2-4-2-9-3-13-2-15-9-29-20-40-8-7-17-14-26-19-6-2-11-4-16-8l-6-8c-12-32-16-67-12-101a285%20285%200%200%201%2037-113c10-16%2022-30%2035-43%2010-9%2020-17%2031-23l14-5%2032-11%2019-2h43c23%200%2044-2%2067%200Z%22%20fill%3D%22%23000000%22%2F%3E%3C%2Fg%3E%3Cg%20transform%3D%22translate(10%20-60)%22%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E"
                      }
                      alt="preview"
                      className="avatar mb-2"
                    />
<input
  type="file"
  id="upload"
  accept="image/*"
  onChange={handleAvatarChange}
/>
<label htmlFor="upload" className="file-upload-label">
  {t("profileModal.uploadLabel")}
</label>

                  </div>

                  <input
                    id="editName"
                    type="text"
                    defaultValue={user.name}
                    className="input-names"
                  />
                  <input
                    id="editEmail"
                    type="email"
                    defaultValue={user.email}
                    className="input-names"
                  />
                  <div className="flexx gap-2">
                    <button
                      onClick={() => setMode("view")}
                      className="btn-secondary flex-1 NoOrYes"
                    >
                      <MdOutlineCancel className="iconYR"  /> <p>{t("profileModal.cancelButton")}</p>
                    </button>
                    <button
                      onClick={handleSave}
                      className="btn-primary flex-1 NoOrYes"
                    >
                      <FaSave className="iconYR" /> <p>{t("profileModal.saveButton")}</p>
                    </button>
                  </div>
                </div>
              )}

              {mode === "logout" && (
                <div className="text-center">
                  <p className="mb-3">{t("profileModal.confirmLogout")}</p>
                  <div className="flexx gap-2">
                    <button
                      onClick={() => setMode("view")}
                      className="btn-secondary flex-1 NoOrYes"
                    >
                      <MdOutlineCancel className="iconYR" /> <p>{t("profileModal.no")}</p>
                    </button>
                    <button
                      onClick={handleLogout}
                      className="btn-primary flex-1 NoOrYes"
                    >
                      <TiTickOutline className="iconYR" /> <p>{t("profileModal.yes")}</p>
                    </button>
                  </div>
                </div>
              )}

              {mode === "delete" && (
                <div className="text-center">
                  <p className="mb-3">{t("profileModal.confirmDelete")}</p>
                  <div className="flexx gap-2">
                    <button
                      onClick={() => setMode("view")}
                      className="btn-secondary flex-1 NoOrYes"
                    >
                      <MdOutlineCancel className="iconYR" /> <p>{t("profileModal.no")}</p>
                    </button>
                    <button
                      onClick={handleDelete}
                      className="btn-danger flex-1 NoOrYes"
                    >
                      <TiTickOutline className="iconYR" /> <p>{t("profileModal.yes")}</p>
                    </button> 
                  </div>
                </div>
              )}
            </>
          )}
        </motion.div>
      </motion.div>
    </AnimatePresence>
  );
}
